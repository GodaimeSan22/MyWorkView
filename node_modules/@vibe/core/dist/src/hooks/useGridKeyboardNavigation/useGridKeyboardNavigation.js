import{slicedToArray as n}from"../../../_virtual/_rollupPluginBabelHelpers.js";import{useState as e,useRef as i,useContext as o,useEffect as t,useCallback as r}from"react";import{GridKeyboardNavigationContext as a}from"../../components/GridKeyboardNavigationContext/GridKeyboardNavigationContext.js";import u from"../useFullKeyboardListeners.js";import c from"../useEventListener/index.js";import{getActiveIndexFromInboundNavigation as s,calcActiveIndexAfterArrowNavigation as d}from"./gridKeyboardNavigationHelper.js";import{useLastNavigationDirection as l}from"../../components/Menu/Menu/hooks/useLastNavigationDirection.js";var f=-1;function v(v){var m=v.ref,b=v.itemsCount,I=v.numberOfItemsInLine,g=v.onItemClicked,p=v.entryFocusStrategy,x=void 0===p?"directional":p,N=v.getItemByIndex,y=void 0===N?function(n){}:N,O=v.focusOnMount,j=void 0!==O&&O,C=v.focusItemIndexOnMount,L=void 0===C?f:C,k=v.disabledIndexes,K=void 0===k?[]:k,M=v.circularNavigation,A=void 0!==M&&M,S=e(j&&L!==f),h=n(S,2),w=h[0],B=h[1],D=i(!1),E=e(w?L:f),F=n(E,2),G=F[0],H=F[1],_=e(!0),P=n(_,2),R=P[0],T=P[1],q=o(a);t((function(){D.current?B(!1):D.current=!0}),[G]);var z=r((function(){var n;return null===(n=m.current)||void 0===n?void 0:n.blur()}),[m]),J=l().lastNavigationDirectionRef,Q=r((function(){if(G===f){var n=J.current;H("directional"===x&&n?s({direction:n,numberOfItemsInLine:I,itemsCount:b}):0),T(!0)}else T(!0)}),[G,x,b,J,I,H,T]),U=r((function(){T(!1)}),[T]),V=r((function(){T(!0),H(f)}),[H]);c({eventName:"focus",callback:Q,ref:m}),c({eventName:"mousedown",callback:U,ref:m}),c({eventName:"blur",callback:V,ref:m}),t((function(){var n;G>-1&&(null===(n=m.current)||void 0===n||n.focus())}),[G,m]);var W=r((function(n){T(arguments.length>1&&void 0!==arguments[1]&&arguments[1]),H(n),g(y(n),n)}),[H,g,y]),X=r((function(){if(R)return W(G,!0)}),[R,W,G]);return u({ref:m,onSelectionKey:X,onArrowNavigation:function(n){if(T(!0),G!==f){var e=d({activeIndex:G,itemsCount:b,numberOfItemsInLine:I,direction:n,disabledIndexes:K,circularNavigation:A}),i=e.nextIndex;e.isOutbound?null==q||q.onOutboundNavigation(m,n):H(i)}else H(0)},onEscape:z,focusOnMount:j}),{activeIndex:R?G:f,onSelectionAction:W,isInitialActiveState:w}}export{v as default};
//# sourceMappingURL=useGridKeyboardNavigation.js.map
